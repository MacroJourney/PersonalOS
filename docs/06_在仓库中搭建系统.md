# 在仓库中搭建 PersonalOS 系统

> **版本**：v2.1
> **更新日期**：2026-02-07
> **文档类型**：搭建指南

---

## 文档导航

本文档是 PersonalOS 系列文档的仓库搭建部分，完整文档体系：

- **[00_核心设计.md](00_核心设计.md)** - 系统概述、架构、人机协作模块、成长管理模块
- **[01_快速开始.md](01_快速开始.md)** - 实施路径、渐进式启动方案
- **[02_30天成长计划.md](02_30天成长计划.md)** - Week 1-4 完整计划、效果预期
- **[03_模板库.md](03_模板库.md)** - 核心模板及使用说明
- **[04_AI配置完整版.md](04_AI配置完整版.md)** - 三个 AI 工作模式的完整 System Prompt
- **[05_FAQ与防坑.md](05_FAQ与防坑.md)** - 常见问题、反模式指南
- **[06_在仓库中搭建系统.md](06_在仓库中搭建系统.md)** - 在仓库内搭建工作空间 + CLAUDE.md 配置（当前文档）

---

## 一、概述

本指南面向**克隆了 PersonalOS 仓库、想直接在仓库内搭建工作空间**的用户。

与 [01_快速开始.md](01_快速开始.md) 的区别：

| 维度 | 01_快速开始 | 本文档 |
|-----|-----------|-------|
| **起点** | 从零创建 PersonalOS 目录 | 克隆仓库后，在仓库内搭建 |
| **优势** | 灵活，可放在任意位置 | 文档、模板、工作空间在同一仓库，随时参考 |
| **Git** | 自行管理 | 仓库自带 `.gitignore`，个人数据自动排除 |
| **AI 配置** | 基础指引 | 包含 CLAUDE.md 引导程序配置（第三章） |

如果你还没克隆仓库，或只想先体验，推荐从 [01_快速开始.md](01_快速开始.md) 的 10 分钟启动开始。

---

## 二、搭建步骤

### 2.1 克隆仓库

```bash
git clone git@github.com:MacroJourney/PersonalOS.git
cd PersonalOS
```

### 2.2 创建工作空间目录

在仓库根目录下执行：

```bash
# 00_Core：核心配置 + 记忆系统
mkdir -p 00_Core/memory

# 02_Human：私人空间
mkdir -p 02_Human/{drafts,notes,personal/{journal,sensitive},review_queue,archive}

# 03_AI：AI 自主空间
mkdir -p 03_AI/{workspace/{drafts,experiments,temp},tools/{scripts,utilities},ai_diary,research,_private}
```

> 01_Shared/ 在 2.4 单独初始化。四区工作空间的设计意图详见 [00_核心设计.md 2.1](00_核心设计.md#21-四区工作空间顶层设计)。

### 2.3 初始化核心配置

00_Core/ 包含四个配置文件和一套记忆系统（详见 [00_核心设计.md 3.1](00_核心设计.md#31-核心配置文件00_core)）：

```bash
# 从模板复制（profile、interaction_rules、stop_conditions 有完整模板）
cp templates/00_Core/profile.template.md 00_Core/profile.md
cp templates/00_Core/interaction_rules.template.md 00_Core/interaction_rules.md
cp templates/00_Core/stop_conditions.template.md 00_Core/stop_conditions.md

# awakening_spell 暂无模板文件，参考 03_模板库.md 创建
touch 00_Core/awakening_spell.md

# 初始化记忆系统
touch 00_Core/memory/{long_term.md,recent_rolling.md,compression_rule.md}
```

填写优先级：

| 文件 | 回答的问题 | 怎么填 |
|-----|----------|-------|
| **profile.md** | 你是谁？ | **最重要**。< 2000 字，五分类：身份与背景、价值观与原则、思维方式与审美、驱动力与触发点、性格与工作风格。可用 [01_快速开始.md](01_快速开始.md) 的 AI 引导法。 |
| interaction_rules.md | AI 怎么和你协作？ | 先写 3-5 条（沟通风格、格式偏好等），用的过程中补充。 |
| stop_conditions.md | 什么时候该停下来确认？ | 先写 3-5 个 AI 必须暂停请示的场景。 |
| awakening_spell.md | 如何启动一次协作？ | 会话初始化指令，加载 profile 和记忆。参考 [03_模板库.md](03_模板库.md)。 |

> 详细的模板内容见 [03_模板库.md](03_模板库.md)，填写示例见 [examples/](../examples/)。

### 2.4 初始化 Obsidian Vault（01_Shared/）

#### 选项 A：使用 Ideaverse 模板

```bash
# Ideaverse Pro 2.5（完整版）或 Zero 2.5（精简版）
# 注意：Ideaverse 是付费内容，需自行购买
cp -r templates/obsidian-vault/Ideaverse\ Pro\ 2.5/* 01_Shared/
# 或
cp -r templates/obsidian-vault/Ideaverse\ Zero\ 2.5/* 01_Shared/
```

#### 选项 B：从空白开始

```bash
mkdir -p 01_Shared/{"+",Atlas/{Dots/{People,Things,Quotes,Statements,Questions,Skills},Maps,Sources/{Books,Articles,Courses,Clippings}},Calendar/{Days,Records,Reviews/{Weekly,Monthly}},Efforts/{Areas,Projects/{Active,Simmering,Sleeping},Works},Strategy/{quarterly,reviews},Meta/{rules,ai-conversations},x/{Templates,Prompts/contexts}}

# 创建关键文件
touch 01_Shared/Strategy/{north-star.md,annual-plan.md}
touch 01_Shared/Meta/rules/_index.md
touch 01_Shared/Atlas/Dots/Skills/_index.md
touch 01_Shared/Home.md
```

然后用 Obsidian 打开 `01_Shared/` 作为 Vault，安装 **Periodic Notes** 和 **Templater** 插件。完整的插件配置见 [00_核心设计.md 6.2](00_核心设计.md#62-obsidian-核心插件)。

---

## 三、配置 CLAUDE.md

如果你使用 **Claude Code** 或 **Cursor** 作为核心协作 AI（推荐，详见 [00_核心设计.md 6.3](00_核心设计.md#63-ai-配置)），需要将 CLAUDE.md 从「仓库说明」替换为「AI 引导程序」。

### 3.1 定位：引导程序，不是仓库说明

仓库自带的 CLAUDE.md 面向贡献者，介绍仓库结构。而你的 CLAUDE.md 需要变成面向**你的数字合伙人**的引导程序：

| 维度 | 仓库说明（当前） | 引导程序（你的版本） |
|-----|---------------|-------------------|
| **面向** | 克隆仓库的人 / 贡献者 | 你的 AI 合伙人 |
| **核心用途** | 介绍仓库结构和文档索引 | 定义协作框架，指引 AI 读取配置 |
| **本质** | 「这个仓库是什么」 | 「你（AI）应该如何启动和工作」 |

### 3.2 配置体系分工

CLAUDE.md 和 00_Core/ 配置文件遵循**单一数据源**原则——每个配置只在一个地方定义，避免冲突：

```
CLAUDE.md（入口 = 宪法 + 引导程序）
    │
    ├── 定义：四区结构、权限边界、核心准则
    ├── 指令：「对话开始时，读取以下文件…」
    │
    ▼
00_Core/（用户配置 = 可变的个人信息）
    ├── profile.md              → 你是谁
    ├── interaction_rules.md    → 怎么协作
    ├── stop_conditions.md      → 什么时候停
    ├── awakening_spell.md      → 如何启动
    └── memory/                 → AI 的持续记忆
```

| 文件 | 职责 | 谁定义 | 变更频率 |
|-----|------|-------|---------|
| **CLAUDE.md** | 系统架构、核心准则、启动流程 | 框架定义 | 几乎不变 |
| **profile.md** | 用户身份、价值观、思维方式 | 你 | 偶尔更新 |
| **interaction_rules.md** | 沟通风格、权限细节 | 你 | 随需调整 |
| **stop_conditions.md** | 安全边界、停止条件 | 你 | 随信任度调整 |
| **memory/** | 动态记忆 | AI 维护 | 每次对话 |
| **规则库 / 技能库** | 复利资产 | 人机共建 | 持续积累 |

**CLAUDE.md 应包含**：身份定义、四区结构、权限边界、核心准则（两条规则）、复利机制位置、三个工作模式的触发时机、启动 / 结束流程。

**CLAUDE.md 不应包含**（放到 00_Core/ 文件中）：用户具体偏好（→ profile.md）、沟通风格细节（→ interaction_rules.md）、具体禁止事项（→ stop_conditions.md）。

### 3.3 使用模板

```bash
# 用引导程序版本替换当前仓库说明版本
cp templates/CLAUDE.template.md CLAUDE.md
```

替换后，Claude Code 在此仓库中工作时会自动读取你的 CLAUDE.md，按引导程序启动：先读取 profile.md 和记忆，再回应你的请求。

> 模板覆盖：四区结构、权限边界、核心准则、复利机制、三个工作模式、启动 / 结束流程。内容见 `templates/CLAUDE.template.md`。

**关于 Git 冲突**：替换 CLAUDE.md 后，`git status` 会显示它被修改。由于你不会推送到上游仓库，这不影响使用。`git pull` 更新时如遇合并提示，保留你的版本即可。

### 3.4 Claude Projects 补充（可选）

如果部分场景不在仓库目录下操作，可用 Claude Projects 作为补充：

1. 在 Claude.ai 创建 Project，上传 `00_Core/profile.md` 等配置文件
2. 添加对应工作模式的 System Prompt（见 [04_AI配置完整版.md](04_AI配置完整版.md)）

局限：Claude Projects 无法自动读写本地文件，复利机制（记忆更新、规则 / 技能沉淀）需手动维护。

---

## 四、Git 与更新

### 4.1 什么会 / 不会被提交

仓库的 `.gitignore` 已配置好，你的个人数据自动被排除：

| 类别 | 内容 | 说明 |
|-----|------|------|
| **会被提交** | `docs/`、`templates/00_Core/`、`examples/`、`references/`、`README.md` 等 | 仓库公共内容 |
| **不会被提交** | `00_Core/`、`01_Shared/`、`02_Human/`、`03_AI/` | 你的私有数据 |
| **不会被提交** | `templates/obsidian-vault/Ideaverse */` | 付费内容 |

### 4.2 获取文档更新

```bash
git pull origin main
```

`git pull` 只会更新 `docs/`、`templates/` 等公共文件，不会覆盖你的个人数据。

### 4.3 备份建议

你的工作区（00_Core/、01_Shared/ 等）不被 Git 追踪，建议定期备份：

- **云盘同步**：把 PersonalOS 目录放在 iCloud / Dropbox / OneDrive 同步文件夹中
- **Obsidian Sync**（付费）：同步 `01_Shared/` 到 Obsidian 云端
- **手动备份**：`tar -czf PersonalOS-backup-$(date +%Y%m%d).tar.gz 00_Core/ 01_Shared/ 02_Human/ 03_AI/`

---

## 五、搭建完成后的目录结构

```
PersonalOS/                          # 仓库根目录
│
├── CLAUDE.md                        # AI 引导程序（替换后）
│
├── 00_Core/                         # 核心配置（.gitignore 排除）
│   ├── profile.md                   # 底层画像
│   ├── interaction_rules.md         # 交互规则
│   ├── stop_conditions.md           # 停止条件
│   ├── awakening_spell.md           # 唤醒咒语
│   └── memory/                      # 记忆系统
│       ├── long_term.md
│       ├── recent_rolling.md
│       └── compression_rule.md
│
├── 01_Shared/                       # Obsidian Vault（.gitignore 排除）
│   ├── Atlas/                       # 能力层：知识管理
│   ├── Calendar/                    # 时间维度
│   ├── Efforts/                     # 项目层：执行管理
│   ├── Strategy/                    # 战略层：方向校准
│   ├── Meta/                        # 系统元数据（规则库在此）
│   ├── x/                           # 系统资源
│   ├── +/                           # 快速捕获
│   └── Home.md                      # 仪表盘
│
├── 02_Human/                        # 私人空间（.gitignore 排除）
│   ├── drafts/、notes/、personal/
│   ├── review_queue/                # 待审核区
│   └── archive/
│
├── 03_AI/                           # AI 自主空间（.gitignore 排除）
│   ├── workspace/、tools/
│   ├── ai_diary/、research/
│   └── _private/
│
├── docs/                            # 文档（Git 管理）
├── templates/                       # 模板（Git 管理）
├── examples/                        # 示例（Git 管理）
└── references/                      # 参考资料（Git 管理）
```

---

## 下一步

1. **填写底层画像** → 最重要的第一步，参考 [01_快速开始.md](01_快速开始.md) 的 AI 引导法
2. **渐进式采用** → 按 [02_30天成长计划.md](02_30天成长计划.md) 的 Week 1-4 节奏，从记录习惯开始
3. **获取模板** → [03_模板库.md](03_模板库.md)，从底层画像到唤醒咒语的完整模板
4. **配置 AI** → [04_AI配置完整版.md](04_AI配置完整版.md)，三个工作模式的完整 System Prompt
5. **遇到问题** → [05_FAQ与防坑.md](05_FAQ与防坑.md)

---

*版本：v2.1 | 更新：2026-02-07*
